%define snapshotrel @SPEC_SNAPSHOTREL@
%define snapshot @SPEC_SNAPSHOT@

Name:          baseboxd
Version:       @SPEC_VERSION@
Release:       1%{?snapshotrel}%{?dist}
Summary:       TODO

License:       BISDN
URL:           http://www.bisdn.de/
Source0:       http://www.bisdn.de/releases/basebox/%{name}-%{version}%{?snapshot}.tar.gz

BuildRequires: autoconf
BuildRequires: automake
BuildRequires: libtool
BuildRequires: rofl-common-devel
BuildRequires: rofl-ofdpa-devel
BuildRequires: libnl3-devel
BuildRequires: libconfig-devel

Requires:      rofl-common
Requires:      rofl-ofdpa
Requires:      libnl3
Requires:      libconfig

BuildRequires: systemd
Requires(post): systemd
Requires(preun): systemd
Requires(postun): systemd

%description
TODO

%package       devel
Summary:       TODO
Group:         System Environment/Daemons
Requires:      %{name} = %{version}-%{release}
Requires:      rofl-common-devel
Requires:      rofl-ofdpa-devel
Requires:      libnl3-devel
Requires:      libconfig-devel


%description	devel
TODO

%prep
%setup -q -n %{name}-%{version}%{?snapshot}


%build
%configure
make %{?_smp_mflags}


%install
rm -rf $RPM_BUILD_ROOT
%make_install

install -p -D -m 0644 pkg/systemd/baseboxd.service \
    %{buildroot}%{_unitdir}/baseboxd.service
install -p -D -m 0644 pkg/systemd/sysconfig.template \
    %{buildroot}%{_sysconfdir}/sysconfig/baseboxd


%post
%systemd_post basebox.service

%preun
%systemd_preun basebox.service

%postun
%systemd_postun


%files
%{_sbindir}/baseboxd
%{_libdir}/libroflibs*.so.*
%{_unitdir}/baseboxd.service
%{_sysconfdir}/sysconfig/baseboxd

%doc README.md


%files devel
%{_libdir}/libroflibs*.a
%{_libdir}/libroflibs*.la
%{_libdir}/libroflibs*.so
%{_includedir}/roflibs/netlink/cconfig.hpp
%{_includedir}/roflibs/netlink/ccookiebox.hpp
%{_includedir}/roflibs/netlink/clogging.hpp
%{_includedir}/roflibs/netlink/cnetdev.hpp
%{_includedir}/roflibs/netlink/cnetlink.hpp
%{_includedir}/roflibs/netlink/cpacketpool.hpp
%{_includedir}/roflibs/netlink/cprefix.hpp
%{_includedir}/roflibs/netlink/crtaddr.hpp
%{_includedir}/roflibs/netlink/crtaddrs.hpp
%{_includedir}/roflibs/netlink/crtlink.hpp
%{_includedir}/roflibs/netlink/crtlinks.hpp
%{_includedir}/roflibs/netlink/crtneigh.hpp
%{_includedir}/roflibs/netlink/crtneighs.hpp
%{_includedir}/roflibs/netlink/crtnexthop.hpp
%{_includedir}/roflibs/netlink/crtnexthops.hpp
%{_includedir}/roflibs/netlink/crtroute.hpp
%{_includedir}/roflibs/netlink/crtroutes.hpp
%{_includedir}/roflibs/netlink/ctapdev.hpp
%{_includedir}/roflibs/netlink/ctundev.hpp

%changelog
* Tue Feb  9 2016 Tobias Jungel
- 
